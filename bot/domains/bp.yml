version: "3.1"

config:
  store_entities_as_slots: true
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: false

intents:
  - welcome
  - stop
  - comment_confirmation
  - out_of_context
  - help
  - add_new_comment:
      ignore_entities:
      - conversation_id

entities:
  - conversation_id

slots:
  contact_name:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  ej_api_connection_error:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
    - type: custom
  anonymous_votes_limit:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  auth_link:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
  participant_can_add_comments:
    type: bool
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  has_completed_registration:
    type: bool
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
  comment_content:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  refresh_token:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  restart_conversation:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
    - type: custom
  access_token:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  conversation_id_cache:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  conversation_id:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: conversation_id
  conversation_statistics:
    type: any
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  conversation_text:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  current_comment_id:
    type: rasa.shared.core.slots.FloatSlot
    initial_value: null
    influence_conversation: false
    max_value: 1.0
    min_value: 0.0
    mappings:
    - type: custom
  number_comments:
    type: rasa.shared.core.slots.FloatSlot
    initial_value: null
    influence_conversation: false
    max_value: 1.0
    min_value: 0.0
    mappings:
    - type: custom
  user_voted_comments:
    type: rasa.shared.core.slots.FloatSlot
    initial_value: null
    influence_conversation: false
    max_value: 1.0
    min_value: 0.0
    mappings:
    - type: custom
  check_authentication:
    type: categorical
    values: 
      - end_participant_conversation
      - check_participant_authentication
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
      - active_loop: authentication_form
        requested_slot: check_authentication
  vote:
    type: text
    influence_conversation: false
    mappings:
    - type: from_text
      conditions:
      - active_loop: vote_form
        requested_slot: vote
  comment_confirmation:
    type: categorical
    values: 
      - Sim
      - Não
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
      - active_loop: vote_form
        requested_slot: comment_confirmation
  comment:
    type: text
    influence_conversation: false
    mappings:
    - type: from_text
      conditions:
      - active_loop: vote_form
        requested_slot: comment
  help_topic:
    type: categorical
    values: 
      - help_plan
      - help_voting
      - help_know_more
      - help_authentication
      - help_lgpd
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
      - active_loop: help_form
        requested_slot: help_topic
  next_count_to_send_profile_question:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
  need_to_ask_profile_question:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
    - type: custom
  profile_question:
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
      - active_loop: profile_form
        requested_slot: profile_question
  profile_question_id:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
  send_profile_questions:
    type: bool
    initial_value: false
    influence_conversation: false
    mappings:
    - type: custom
  votes_to_send_profile_questions:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom

responses:
  utter_bot_introduction:
  - text: |
        Olá {contact_name}, tudo bem? Eu sou a Iara e este é um espaço de escuta do Ministério da Cultura 💬.
        Estamos elaborando um Plano que vai guiar as políticas culturais pelos próximos 10 anos e queremos saber sua opinião 📢.
        Funciona assim: eu apresento frases sobre cultura e você me diz se concorda, discorda ou se prefere pular. É só clicar no botão correspondente. 👆

        Se precisar de auxílio é só escrever ajuda que eu te apresento as opções.🆘
  utter_show_topic_of_discussion:
  - text: |
        Ao continuar nossa conversa, você concorda com o termo de uso disponível em: https://brasilparticipativo.presidencia.gov.br/processes/brasilparticipativo/f/78 ✅ Vamos lá?

        *{conversation_text}*
  utter_ask_comment_confirmation:
  - text: |
        Gostaria de dar sua opinião sobre o tema para que eu possa enviá-la aos outros participantes da coleta?
    buttons:
    - title: Sim
      payload: sim
    - title: Não
      payload: não
  utter_ask_comment:
  - text: Pode enviar seu comentário que eu anoto aqui!
  utter_go_back_to_voting:
  - text: Sem problemas, vou te mandar o que mais me responderam!
  utter_vote_received:
  - text: |
        Anotado ✍️Vou te mostrar outras frases
  - text: |
        🙂 Recebi sua opinião! Dando sequência:
  - text: |
        Contribuição recebida! 🌟 Avançando para mais...
  - text: |
        ✅ Confirmado! Próxima pergunta:
  - text: |
        Resposta recebida. 📢 Além da enquete, estamos coletando propostas para o futuro da cultura no Brasil! Você pode participar no Brasil Participativo! Avançando:
  - text: |
        Sucesso! 👍 Mais uma pergunta:
  - text: |
        📦 Recebi! Mais uma questão importante:
  - text: |
        💡Confirmado! Suas respostas serão analisadas pelo Ministério da Cultura para o novo Plano Nacional de Cultura. Próxima:
  - text: |
        📋 Anotei! Dando sequência:
  - text: |
        📬 Opinião recebida com sucesso! Continuando:
  - text: |
        📡 Resposta acolhida! Estamos chegando ao fim. Mais uma pergunta:
  - text: |
        Confirmado! 💡 Tem uma proposta para o futuro da cultura? Continue essa participação no Brasil Participativo! Próxima pergunta:
  - text: |
        📝 Resposta registrada! Falta pouco! Mais uma pergunta:
  - text: |
        Sua participação é valiosa! 📊 Vamos para o próximo tópico?
  - text: |
        🧮 Feito! (símbolo) Última pergunta:
  - text: |
        Pronto! ✅ Adiante:
  - text: |
        Sua voz foi ouvida! 🎙️ Vamos para outro ponto?
  utter_out_of_context:
  - text: Desculpe, não sei se entendi 😕
  utter_sent_comment:
  - text: Certo, anotei seu comentário e o enviarei para outros participantes da pesquisa. Deixa eu ver se ainda tenho outras opiniões pra te enviar.
  utter_send_comment_error:
  - text: Eu não consegui salvar seu comentário 😕, pois já existe um comentário com o mesmo texto.
  utter_comment_fallback:
  - text: Desculpe, não foi possível reconhecer o comentário 😕.
  utter_voted_all_comments:
  - text: "{contact_name}, parabéns! Você respondeu às perguntas que tinha aqui."
  utter_thanks_participation:
  - text: |
          Parabéns, {contact_name}! Você respondeu todas as minhas perguntas.
          Continue participando com a gente! Estamos coletando propostas para o futuro da cultura no Brasil. Se você tiver uma ideia ou quiser apoiar as já existentes, acesse o Brasil Participativo. Suas respostas e as propostas coletadas serão analisadas pelo MinC para o novo Plano Nacional de Cultura. Participe!
  utter_next_conversation:
  - text: Depois conversamos mais 😘
  utter_ej_communication_error:
  - text: Ops! Nossos sistemas estão passando por uma manutenção e estão temporariamente indisponíveis. Estimamos que o serviço estará normalizado em alguns minutos. Pedimos desculpas por qualquer inconveniente.
  utter_error_try_again_later:
  - text: Tive um problema técnico, por favor tente participar mais tarde.
  utter_ask_help_topic:
  - text: |
        Olá! Eu sou a Iara! Como posso te ajudar hoje? Escolha uma das opções a seguir:
    buttons:
    - title: ℹ️ Saber mais sobre o processo
      payload: help_know_more
    - title: 🤔  Saber como as respostas serão usadas
      payload: help_voting
    - title: 📥 Colaborar com o Plano
      payload: help_plan
    - title: 🔑 Ajuda com autenticação
      payload: help_authentication
    - title: 🛡️ Segurança dos dados
      payload: help_lgpd
  utter_nlu_fallback:
    - text: |
          Opa, fiquei um pouco confusa com a sua mensagem. 
          Mas não tem problema, me manda uma mensagem com o texto 'ajuda' que te envio o que eu sei sobre essa pesquisa realizada pelo Ministério da Cultura.
  utter_explain_help_voting:
    - text: |
          📝 As respostas desta enquete serão agrupadas e analisadas pelo Ministério da Cultura para a construção do Plano. Queremos entender o que mais importa para você! O resultado vai ser divulgado no Brasil Participativo.  Lembrando que  essa não é uma pesquisa quantitativa de opinião. Fique ligado lá: gov.br/pncparticipativo

          Caso queira retomar a pesquisa, basta me mandar um oi.
  utter_explain_help_know_more:
    - text: |
          Esse é um processo de participação para a construção do novo Plano Nacional de Cultura. Aqui, você dá sua opinião sobre os principais temas do Plano ao clicar em concordar, discordar ou pular com as frases que eu apresento. Com isso, o Ministério vai poder conhecer o que é mais relevante para as pessoas e estratégico para o Plano. 

          Além disso, você pode participar nas oficinas presenciais em todos os Estados e sugerir e votar em metas para os próximos 10 anos da cultura no Brasil Participativo. Para saber mais e colaborar clique em: https://gov.br/pncparticipativo.

          Caso queira retomar a pesquisa, basta me mandar um oi.
  utter_explain_help_authentication:
    - text: |
          Para garantir que suas contribuições sejam válidas e seguras, precisamos que você faça uma autenticação simples. Isso ajuda a verificar sua identidade. O processo é rápido e fácil! Entre em {auth_link} e clique em LOGIN. Coloque o seu CPF e a senha do Gov.br. É a mesma que você usa para acessar os serviços. Depois, confirme e pronto! Você já se autenticou e pode voltar para nossa conversa aqui.

          Caso queira retomar a pesquisa, basta me mandar um oi.
  utter_explain_help_lgpd:
    - text: |
          Todas as informações coletadas são armazenadas de forma segura e utilizadas para o desenvolvimento e mobilização do novo Plano Nacional de Cultura. Nós nos comprometemos a tratar esses dados de forma conjunta e não divulgá-los para terceiros.
          Para saber mais, clique em: https://brasilparticipativo.presidencia.gov.br/processes/brasilparticipativo/f/78

          Caso queira retomar a pesquisa, basta me mandar um oi.
  utter_explain_help_plan:
    - text: |
          Além dessa enquete, você tem outras formas de colaborar com o Plano: acesse o Brasil Participativo, sugira e vote em metas para o futuro da cultura no Brasil. Você também pode participar de oficinas presenciais e colaborar com o texto base. Para saber mais e participar clique em: https://gov.br/pncparticipativo.

          Caso queira retomar a pesquisa, basta me mandar um oi.
  utter_advise_participant_to_join_again:
  - text: "Não consegui salvar o seu voto. Clique no link de participação novamente, para retomarmos nossa conversa.\n"
  utter_invalid_vote_during_participation:
  - text: | 
        Você ainda está participando da conversa *{conversation_text}* e a sua resposta no comentário *{comment_content}* não foi válida. Poderia responder novamente? 

        Caso esteja com problemas, você pode parar essas conversa e em seguida me pedir ajuda!

        Vou te reenviar o comentário dessa pesquisa.
  utter_vote_limit_anonymous_reached:
  - text: |
        Você está indo muito bem, {contact_name}!
        Para poder continuar votando por aqui e receber relatórios exclusivos do Brasil Participativo, autentique-se agora e aproveite!
        Lá você também pode votar nas frases que você pulou por aqui.
  utter_get_token:
  - text: |
        Aqui está o link para se autenticar:

        {auth_link}
  utter_awaiting_authentication:
  - text: "Estou aguardando você se autenticar para continuar a votação. 😊"
  utter_authenticated:
  - text: "Muito obrigado! Validei sua autenticação, podemos continuar."
  utter_error_during_authentication_validation:
  - text: "Não consegui identificar que você se autenticou. Poderia tentar novamente?"
  utter_profile_intro:
  - text: Para personalizar essa experiência, gostaríamos de saber um pouquinho mais sobre você. Tudo bem?
  utter_profile_received:
  - text: Obrigada por responder! 😊
  - text: Anotado! 😊
  - text: Recebido! 😊
  - text: Anotei! 😊
  utter_profile_fallback:
  - text: Desculpe, não consegui entender o que você disse. Clique em uma das opções para que eu entenda melhor.
  utter_return_from_help:
  - text: Olá, {contact_name} vamos continuar a enquete? Estamos ouvindo diferentes pessoas para saber o que elas pensam sobre cultura. 🎯

actions:
- action_reset_help_slots
- action_ask_vote
- validate_vote_form
- action_ask_profile_question
- validate_profile_form
- action_get_conversation
- action_set_new_comment
- action_customized_fallback
- action_ask_check_authentication
- validate_authentication_form
- validate_help_form

forms:
  help_form:
    required_slots:
      - help_topic
    ignored_intents:
      - stop
      - check_authentication
  authentication_form:
    ignored_intents:
      - stop
    required_slots:
      - check_authentication
      - has_completed_registration
  vote_form:
    ignored_intents:
      - stop
      - check_authentication
      - help
    required_slots:
      - vote
      - comment_confirmation
      - comment
  profile_form:
    required_slots:
      - profile_question

e2e_actions: []
