version: "2.0"

rules:
  - rule: User doesn't want to participate anymore
    steps:
      # This unhappy path handles the case of an intent `stop`.
      - intent: stop
      - action: utter_stopped
      - action: utter_next_conversation
      - action: utter_finish
      - active_loop: null
      - active_loop: action_restart

  - rule: Set conversation id for webchat
    steps:
      - intent: url
      - slot_was_set:
        - url
      - action: utter_introduce_ej
      - action: action_get_conversation_info
      - slot_was_set:
        - conversation_id
      - action: utter_show_usage_terms
      - action: utter_show_topic_of_discussion
      - action: action_setup_conversation
      - action: vote_form
      - active_loop: vote_form
      
  - rule: Help command
    steps:
      - intent: help
      - action: utter_help
  
  - rule: Show help fallback when low NLU confidence
    steps:
      - intent: nlu_fallback
      - action: utter_help

  - rule: end voting form
    condition:
        - active_loop: vote_form
    steps:
      - action: vote_form
      - active_loop: null
      - action: action_follow_up_form
      - action: utter_next_conversation
      - action: utter_finish
      - action: action_restart
